(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/lotunpack/lotunpack"],{2842:function(t,e,i){"use strict";i.r(e);var n=i("35c2"),o=i.n(n);for(var l in n)"default"!==l&&function(t){i.d(e,t,function(){return n[t]})}(l);e["default"]=o.a},"35c2":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(i("2e17")),o=(s(i("f2a9")),s(i("00e0")),s(i("409c"))),l=s(i("654b"));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(){return Promise.all([i.e("common/vendor"),i.e("components/label-print/label-print")]).then(i.bind(null,"831b"))},u=function(){return i.e("components/uni-swipe-action/uni-swipe-action").then(i.bind(null,"c480"))},c=function(){return i.e("components/uni-list/uni-list").then(i.bind(null,"0f18"))},d=function(){return i.e("components/uni-list-item/uni-list-item").then(i.bind(null,"62a3"))},r={name:"lotunpack",components:{uniSwipeAction:u,uniList:c,uniListItem:d,labelPrint:a},data:function(){var t=0;return{isShowSaveSelected:!1,isSaveSelected:!1,showReport:!1,reportModel:{isMultiPrint:!1,dataSource:[],isNeedValidTag:!1},showView:!1,details:[],det_id:0,num:"",numQty:"",options1:[{text:"删除",style:{backgroundColor:"rgb(255,58,49)"}}],offsetTop:t}},props:{show:{type:Boolean,default:!1},title:{type:String,default:"标签打印"},h5Top:{type:Boolean,default:!1},model:{type:Object,required:!0},printDetail:{type:Array,default:function(){return[]}},progNo:{type:String,required:!0},isSaveSplit:{type:Boolean,default:!0}},watch:{h5Top:function(t){this.offsetTop=t?44:0},printDetail:{immediate:!0,handler:function(e){if(console.log(e," at components\\lotunpack\\lotunpack.vue:208"),0!=e.length){console.log(JSON.stringify(e)," at components\\lotunpack\\lotunpack.vue:210");for(var i=0,n=0;n<e.length;n++){var l=e[n],s=o.default.floatObj.multiply(l.num,l.numQty);i=o.default.floatObj.add(i,s)}if(this.model.sheetQty!=i)throw t.showToast({title:"拆包的数据中，数量拆分后总数不对",icon:"none"}),"拆包的数据中，数量拆分后总数不对";this.details=o.default.clone(e)}}},show:{immediate:!0,handler:function(t){this.showView=t,0==this.printDetail.length&&(this.num=1)}}},computed:{},onReady:function(){t.hideKeyboard(),this.checkUseDefaultPrint()},methods:{checkUseDefaultPrint:function(){var t=this.$refs.labPri.checkUseDefaultPrint();this.isSaveSelected=t,this.isShowSaveSelected=t},cbxChange:function(){this.isSaveSelected=!this.isSaveSelected},bindClick:function(t){for(var e=0,i=this,n=0;n<this.details.length;n++){var l=this.details[n];if(l.det_id==t.det_id){i.details.splice(n,1);break}}for(n=0;n<this.details.length;n++)e+=o.default.floatObj.multiply(this.details[n].num,this.details[n].numQty);this.num=1,this.numQty=o.default.floatObj.subtract(this.model.sheetQty,e)},onNumAdd:function(e){if(this.numQty<=0)t.showToast({title:"数量必须要大于0",icon:"none"});else if(this.num<=0)t.showToast({title:"包数必须要大于0",icon:"none"});else{for(var i=0,n=0;n<this.details.length;n++){var l=o.default.floatObj.multiply(this.details[n].num,this.details[n].numQty);i=o.default.floatObj.add(i,l)}var s=o.default.floatObj.multiply(this.numQty,this.num),a=o.default.floatObj.add(i,s),u=o.default.floatObj.subtract(this.model.sheetQty,a),c=u;c<0?t.showToast({title:"数量录入有误",icon:"none"}):(this.details.push({det_id:this.det_id,num:this.num,numQty:this.numQty}),this.det_id+=1,this.numQty=c,this.num=0==c?0:1)}},onSubmitPrint:function(e){if(0!=this.details.length){for(var i=0,n=0;n<this.details.length;n++){var s=o.default.floatObj.multiply(this.details[n].num,this.details[n].numQty);i=o.default.floatObj.add(i,s)}if(i==this.model.sheetQty)if(1!=this.details.length||1!=this.details[0].num){var a=[],u=0,c=this.model.tagId;for(n=0;n<this.details.length;n++)for(var d=this.details[n],r=0;r<d.num;r++){u++;var h=o.default.clone(this.model);h.sheetQty=d.numQty;var f="".concat(c,"-").concat(u);if(f.length>=46){var p=c.lastIndexOf("-"),m=Number(c.substring(c.length-3));if(p==c.length-4&&l.default.isNumber(m)){var b=m+1;h.tagId="".concat(c.substring(0,c.length-4),"-").concat(o.default.getSuffix(3,b))}else h.tagId="".concat(c,"-001");c=h.tagId}else h.tagId=f;h.inoutFlag="1",a.push(h)}this.reportModel.dataSource=a,console.log(this.isSaveSelected," at components\\lotunpack\\lotunpack.vue:386"),this.isSaveSelected?this.$refs.labPri.userDefaultPrint():this.showReport=!0}else t.showToast({title:"请拆包打印",icon:"none"});else t.showToast({title:"请录入剩余包装数量",icon:"none"})}else t.showToast({title:"请录入包装信息",icon:"none"})},printComplete:function(){this.isSaveSplit&&this.saveSplit(this.reportModel.dataSource),this.showReport=!1,this.details=[],this.showView=!1,this.checkUseDefaultPrint(),this.$emit("printComplete")},printCancel:function(){this.details=[],this.showReport=!1,this.$emit("printCancel")},saveSplit:function(e){var i=this,l=o.default.clone(e),s=o.default.clone(this.model);s.inoutFlag="2",l.insert(0,s),console.log("提交拆分的数据list: "," at components\\lotunpack\\lotunpack.vue:415"),console.log(o.default.outputLog(l)," at components\\lotunpack\\lotunpack.vue:416"),t.showLoading({mask:!0}),n.default.binno_split({data:l,success:function(t){i.hide()},failure:function(t){o.default.showAudio()},complete:function(e,i,n){o.default.tryCatchApi({status:e,message:i}),t.hideLoading()}})},hide:function(){this.details=[],this.showView=!1,this.$emit("cancel")}}};e.default=r}).call(this,i("6e42")["default"])},"634b":function(t,e,i){"use strict";var n=i("b562"),o=i.n(n);o.a},acb4:function(t,e,i){"use strict";i.r(e);var n=i("f724"),o=i("2842");for(var l in o)"default"!==l&&function(t){i.d(e,t,function(){return o[t]})}(l);i("634b");var s=i("2877"),a=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=a.exports},b562:function(t,e,i){},f724:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},o=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o})}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/lotunpack/lotunpack-create-component',
    {
        'components/lotunpack/lotunpack-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('6e42')['createComponent'](__webpack_require__("acb4"))
        })
    },
    [['components/lotunpack/lotunpack-create-component']]
]);                
