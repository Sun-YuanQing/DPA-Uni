(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/otherIO/otherIO-outDet"],{"3bbd":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=l(o("2e17")),n=l(o("f2a9")),s=l(o("00e0")),i=l(o("409c")),r=o("2f62");function l(t){return t&&t.__esModule?t:{default:t}}function u(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},a=Object.keys(o);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),a.forEach(function(e){d(t,e,o[e])})}return t}function d(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var c=function(){return o.e("components/barcode-input/barcode-input").then(o.bind(null,"d7ce"))},h=function(){return Promise.all([o.e("common/vendor"),o.e("components/lotunpack/lotunpack")]).then(o.bind(null,"acb4"))},f={components:{barcodeInput:c,lotunpack:h},data:function(){return{progNo:"",old:{scrollTop:0},scrollTop:0,scrollHeight:0,isStorageBin:null,binNo:"",binWhNo:"",showLotUnpack:!1,printMode:{},printDetail:[],orderItemSelected:{},order:{},scan_qrCode:[]}},onLoad:function(t){this.progNo=t.progNo,this.order=this.urldata,this.isStorageBin=s.default.get(n.default.storageKeys.IsStorageBin)},onReady:function(){i.default.getListHeight(this)},onBackPress:function(t){return i.default.backPress(t,this.order.details)},computed:(0,r.mapState)(["urldata"]),methods:u({},(0,r.mapMutations)(["pageIO_true"]),{onPartScaned:function(e){var o=this,s=this;t.showLoading({mask:!0}),a.default.OpenMes_mesqrcodeinout({data:{qrCode:e},success:function(a){console.log(a," at pages\\otherIO\\otherIO-outDet.vue:102");for(var r=!1,l=0;l<o.scan_qrCode.length;l++){var u=o.scan_qrCode[l];u==e&&(r=!0)}if(r)return t.showToast({title:"该标签已扫!!!",icon:"none"}),void i.default.showAudio();o.scan_qrCode.push(e);var d=[],c=/\d+/g;o.order.details.forEach(function(t){var e=t.sheetLot.match(c);d.push(e[1])}),d.sort(function(t,e){return t-e});for(var h=parseInt(d[d.length-1])+1,f=(l=0,o.order.details.length);l<f;l++){var p=o.order.details[l];if(!p.m_isScan)if(p.tagDetails=p.tagDetails||[],p.m_isScan=!1,a.tagDetails){if(a.tagDetails.length>1)return t.showToast({title:"请扫箱标签^_^",icon:"none"}),void i.default.showAudio();for(var y=0,g=a.tagDetails.length;y<g;y++){var m=a.tagDetails[y];if(m.qrCode=e,p.partItemNo==m.partItemNo){if(!0,s.isStorageBin||(m.binWhNo=m.binWhNo||m.binNo),m.entityState=n.default.entityState.added,p.sheetQty==m.sheetQty){console.log(p.sheetQty+"---"+m.sheetQty," at pages\\otherIO\\otherIO-outDet.vue:172"),o.onScrollTop(l),p.m_isScan=!0,m.inoutFlag=2,p.tagDetails.push(m),p.inLot=m.inLot,p.proDate=new Date(m.proDate).format("yyyy/MM/dd")||(new Date).format("yyyy/MM/dd"),i.default.showScanedAudio();break}}else!1}}else{if(p.partItemNo!=a.partItemNo){!1;continue}if(!0,a.qrCode=e,s.isStorageBin||(a.binWhNo=a.binWhNo||a.binNo),a.entityState=n.default.entityState.added,p.sheetQty==a.sheetQty){console.log(p.sheetQty+"---"+a.sheetQty," at pages\\otherIO\\otherIO-outDet.vue:202"),o.onScrollTop(l),p.m_isScan=!0,a.inoutFlag=2,p.tagDetails.push(a),p.inLot=a.inLot,p.proDate=new Date(a.proDate).format("yyyy/MM/dd")||(new Date).format("yyyy/MM/dd"),i.default.showScanedAudio();break}}}console.log("第二次轮询 比较大小，大就拆分"," at pages\\otherIO\\otherIO-outDet.vue:216");for(l=0,f=o.order.details.length;l<f;l++){console.log("第二次轮询 比较大小，大就拆分"," at pages\\otherIO\\otherIO-outDet.vue:218");p=o.order.details[l];if(!p.m_isScan)if(p.tagDetails=p.tagDetails||[],p.m_isScan=!1,a.tagDetails){if(a.tagDetails.length>1)return t.showToast({title:"请扫箱标签^_^",icon:"none"}),void i.default.showAudio();console.log("第二次轮询 比较大小，大就拆分"," at pages\\otherIO\\otherIO-outDet.vue:237");for(y=0,g=a.tagDetails.length;y<g;y++){m=a.tagDetails[y];if(p.partItemNo==m.partItemNo){if(!0,s.isStorageBin||(m.binWhNo=m.binWhNo||m.binNo),m.entityState=n.default.entityState.added,console.log(g," at pages\\otherIO\\otherIO-outDet.vue:256"),p.sheetQty<m.sheetQty)return console.log(p.sheetQty+"---"+m.sheetQty," at pages\\otherIO\\otherIO-outDet.vue:259"),o.onScrollTop(l),i.default.showAudio(),t.showModal({title:"提示",content:"外箱数量不能大于入库数量!!!",showCancel:!1,success:function(t){t.confirm||t.cancel}}),void s.$refs.input_part.setFocus();if(p.sheetQty>m.sheetQty){console.log(p.sheetQty+"---"+m.sheetQty," at pages\\otherIO\\otherIO-outDet.vue:274"),o.onScrollTop(l);var S=i.default.floatObj.subtract(p.sheetQty,m.sheetQty);p.sheetQty=Number(m.sheetQty);var b=i.default.clone(p);p.m_isScan=!0,m.inoutFlag=2,p.tagDetails.push(m),p.inLot=m.inLot,p.proDate=new Date(m.proDate).format("yyyy/MM/dd")||(new Date).format("yyyy/MM/dd"),b.m_isclone=!0,b.sheetLot=b.sheetLot.split("_")[0]+"_"+i.default.getSuffix(3,h),b.sheetQty=S,o.order.details.push(b),i.default.showScanedAudio();break}}else!1}}else{if(p.partItemNo!=a.partItemNo){!1;continue}if(!0,s.isStorageBin||(a.binWhNo=a.binWhNo||a.binNo),a.entityState=n.default.entityState.added,p.sheetQty>a.sheetQty){console.log(p.sheetQty+"---"+a.sheetQty," at pages\\otherIO\\otherIO-outDet.vue:312"),o.onScrollTop(l);S=i.default.floatObj.subtract(p.sheetQty,a.sheetQty);p.sheetQty=Number(a.sheetQty);b=i.default.clone(p);p.m_isScan=!0,a.inoutFlag=2,p.tagDetails.push(a),p.inLot=a.inLot,p.proDate=new Date(a.proDate).format("yyyy/MM/dd")||(new Date).format("yyyy/MM/dd"),b.m_isclone=!0,b.sheetLot=b.sheetLot.split("_")[0]+"_"+i.default.getSuffix(3,h),b.sheetQty=S,o.order.details.push(b),i.default.showScanedAudio();break}if(p.sheetQty<a.sheetQty)return console.log(p.sheetQty+"---"+a.sheetQty," at pages\\otherIO\\otherIO-outDet.vue:332"),o.onScrollTop(l),i.default.showScanedAudio(),void o.tag_split(a,p.sheetQty)}}i.default.automateSave(s.order.details,"m_isScan",1,s.onSave)},failure:function(t){i.default.showAudio()},complete:function(e,a,n){o.$refs.input_part.setFocus(),i.default.tryCatchApi({status:e,message:a}),t.hideLoading()}})},tag_split:function(t,e){var o=[];o.push({num:1,numQty:e}),o.push({num:1,numQty:i.default.floatObj.subtract(t.sheetQty,e)}),this.printMode=t,this.printDetail=o,this.showLotUnpack=!0},onSave:function(){for(var e=this,o=this,r=0;r<this.order.details.length;r++){var l=this.order.details[r];if(!l.m_isScan)return i.default.showAudio(),void t.showToast({icon:"none",title:"请较对出库物料!"});l.m_isclone?l.entityState=n.default.entityState.added:l.entityState=n.default.entityState.modified,l.sheetSta=2}this.order.entityState=n.default.entityState.modified,this.order.sheetSta=2,console.log(o.order," at pages\\otherIO\\otherIO-outDet.vue:392"),a.default.OpenMes_other({data:o.order,success:function(a){t.showToast({title:"保存成功!",icon:"none"}),i.default.dataInit(e),o.pageIO_true(),o.isStorageBin=s.default.get(n.default.storageKeys.IsStorageBin),i.default.showScanedAudio()},failure:function(t){i.default.showAudio()},complete:function(o,a,n){e.$refs.input_part.setFocus(),i.default.tryCatchApi({status:o,message:a}),t.hideLoading()}})},lotupackCancel:function(){this.printDetail=[];var t=this.scan_qrCode.length;this.scan_qrCode.splice(t-1,1),this.showLotUnpack=!1,this.$refs.input_part.setFocus()},onSelectedItem:function(t){for(var e=0;e<this.order.details.length;e++){var o=this.order.details[e];e==t?(o.selectItemClass="uni-list-cell-selected",this.orderItemSelected=o):o.selectItemClass=""}},scroll:function(t){this.old.scrollTop=t.detail.scrollTop},onScrollTop:function(e){var o=this;this.onSelectedItem(e);var a=t.createSelectorQuery().in(this).select(".scroll-view-item");a.boundingClientRect(function(t){o.scrollTop=o.old.scrollTop,null!=t&&o.$nextTick(function(){this.scrollTop=t.height*e})}).exec()}})};e.default=f}).call(this,o("6e42")["default"])},"4b77":function(t,e,o){"use strict";o.r(e);var a=o("54b2"),n=o("995a");for(var s in n)"default"!==s&&function(t){o.d(e,t,function(){return n[t]})}(s);var i=o("2877"),r=Object(i["a"])(n["default"],a["a"],a["b"],!1,null,null,null);e["default"]=r.exports},"54b2":function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},n=[];o.d(e,"a",function(){return a}),o.d(e,"b",function(){return n})},"995a":function(t,e,o){"use strict";o.r(e);var a=o("3bbd"),n=o.n(a);for(var s in a)"default"!==s&&function(t){o.d(e,t,function(){return a[t]})}(s);e["default"]=n.a}},[["45f6","common/runtime","common/vendor"]]]);