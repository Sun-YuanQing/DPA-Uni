(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/storage/storage-inventory"],{"0eb5":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=r(o("2e17")),n=r(o("f2a9")),s=r(o("00e0")),i=r(o("409c"));function r(t){return t&&t.__esModule?t:{default:t}}var u=function(){return o.e("components/barcode-input/barcode-input").then(o.bind(null,"d7ce"))},l={components:{barcodeInput:u},data:function(){return{details:[],order:{scrollTop:0},scrollTop:0,scrollHeight:0,placeholder_store:"",isStorageBin:null,binNo:"",binWhNo:"",whNo:"",partItemNo:""}},onLoad:function(t){var e=this;this.isStorageBin=s.default.get(n.default.storageKeys.IsStorageBin),this.isStorageBin?e.placeholder_store="扫描储位":e.placeholder_store="扫描仓库"},onReady:function(){i.default.getListHeight(this)},onBackPress:function(t){return i.default.backPress(t,this.order.details)},methods:{onPartScaned:function(e){var o=this;t.showLoading({title:"加载中..",mask:!0}),a.default.inventory_management({data:{whNo:this.whNo,partItemNo:this.partItemNo},success:function(e){console.log("盘点日志打印: "+JSON.stringify(e)," at pages\\storage\\storage-inventory.vue:95"),e?a.default.inventory_managementList({data:{sheetId:0},success:function(t){console.log("提交更新数据:"+t," at pages\\storage\\storage-inventory.vue:110"),o.details.push({mode:t}),o.$refs.stroga_part.setFoust(),i.default.showScanedAudio()}}):t.uni.showToast({title:"该盘点单不存在"})},failure:function(t){i.default.showAudio(),o.$refs.input_part.setFoust()},complete:function(e,o,a){i.default.tryCatchApi({status:e,message:o}),t.hideLoading()}})},onStrogaScaned:function(e){var o=this;e.length<=0?t.showToast({title:"不能输入空值!",icon:"none"}):(t.showToast({title:"加载中...",mask:!0}),this.isStorageBin?a.default.bas_storagebin({data:{binNo:e},success:function(e){if(console.log(i.default.outputLog(e)," at pages\\storage\\storage-inventory.vue:154"),e.length<=0)return t.showToast({title:"货架不存在!",icon:"none"}),i.default.showAudio(),void o.$refs.stroga_part.setFoust();o.binNo=e[0].binNo,o.binWhNo=e[0].whNo,o.$refs.input_partNo.setFoust(),i.default.showScanedAudio()},failure:function(t){o.$refs.input_store.setFocus(),i.default.showAudio()},complete:function(e,o,a){i.default.tryCatchApi({status:e,message:o}),t.hideLoading()}}):(console.log(e," at pages\\storage\\storage-inventory.vue:183"),a.default.bas_wh({data:{filter:'whNo = "'+e+'"'},success:function(e){console.log(i.default.outputLog(e)," at pages\\storage\\storage-inventory.vue:189"),e.length<=0?(t.showToast({title:"仓库不存在!",icon:"none"}),o.$refs.input_store.clear(),i.default.showAudio()):(o.binWhNo=e[0].whNo,o.$refs.input_part.setFocus(),i.default.showScanedAudio())},failure:function(t){o.$refs.input_store.setFocus(),i.default.showAudio()},complete:function(e,o,a){i.default.tryCatchApi({status:e,message:o}),t.hideLoading()}})))},onPartNoScaned:function(e){var o=this;t.showToast({title:"加载中..",mask:!0}),a.default.OpenMes_mesqrcodeinout({data:{qrCode:e},success:function(a){console.log("扫描物料:"+a," at pages\\storage\\storage-inventory.vue:228");for(var n=!1,s=function(){var a=o.details[r];if(a.qrCode==e)return n=!0,t.showModal({title:"提示",cancelText:"该物料已盘点过,是否删除",success:function(t){t.confirm?a.tagDetails.splice(j,1):t.cancel}}),{v:void 0}},r=0;r<o.details.length;r++){var u=s();if("object"===typeof u)return u.v}n?t.showToast({title:"该物料不属于该盘点盒"}):(o.details.push({mode:a,qrCode:e}),i.default.showScanedAudio())},failure:function(t){i.default.showAudio()},complete:function(e,a,n){o.$refs.input_partNo.setFoust(),i.default.tryCatchApi({status:e,message:a}),t.hideLoading()}})},save:function(){for(var e=this,o=this,s=[],r=function(){var t=e.details[u].mode;t.model.tagDetails?t.model.tagDetails.forEach(function(e){var a={};a.sheetType=e.sheetType,a.sheetNo=e.sheetNo,a.sheetLot=e.sheetLot,a.partNo=e.partNo,a.purLot=e.poMoSoLot,a.proLot=e.proLot,a.sheetQty=e.sheetQty,a.inLot=e.inLot,a.proDate=e.proDate,a.tagId=e.tagId,a.boxTagId=e.boxTagId,a.custTagId=e.custTagId,a.ordLot=e.ordLot,a.custNo=e.custNo,o.isStorageBin?(a.binNo=item_tagl.binNo,a.binWhNo=item_tagl.binWhNo):(a.binNo=item_tagl.binWhNo,a.binWhNo=item_tagl.binWhNo),a.qrCode=t.qrCode,a.sourceType="1",a.inoutFlag="1",a.entityState=n.default.entityState.added,s.push(a)}):(l={},l.sheetType=t.mode.sheetType,l.sheetNo=t.mode.sheetNo,l.sheetLot=t.mode.sheetLot,l.partNo=t.mode.partNo,l.purLot=t.mode.poMoSoLot,l.proLot=t.mode.proLot,l.sheetQty=t.mode.sheetQty,l.inLot=t.mode.inLot,l.proDate=t.mode.proDate,l.tagId=t.mode.tagId,l.boxTagId=t.mode.boxTagId,l.custTagId=t.mode.custTagId,l.ordLot=t.mode.ordLot,l.custNo=t.mode.custNo,o.isStorageBin?(l.binNo=t.model.binNo,l.binWhNo=t.model.binWhNo):(l.binNo=t.model.binWhNo,l.binWhNo=t.model.binWhNo),l.qrCode=t.qrCode,l.sourceType="1",l.inoutFlag="1",l.entityState=n.default.entityState.added,s.push(l))},u=0;u<this.details.length;u++){var l;r()}t.showLoading({title:"加载中..",mask:!0}),a.default.inventory_managementUpdata({data:s,success:function(t){console.log("提交更新数据:"+t," at pages\\storage\\storage-inventory.vue:346"),o.isStorageBin?o.placeholder_store="扫描储位":o.placeholder_store="扫描仓库"}}),i.default.dataInit(this)},onSelectedItem:function(t){for(var e=0;e<this.details.length;e++){var o=this.details[e];o.selectItemClass=e==t?"uni-list-cell-selected":""}},scroll:function(t){this.old.scrollTop=t.detail.scrollTop},onScrollTop:function(e){var o=this;this.onSelectedItem(e);var a=t.createSelectorQuery().in(this).select(".scroll-view-item");a.boundingClientRect(function(t){o.scrollTop=o.old.scrollTop,o.$nextTick(function(){this.scrollTop=t.height*e})}).exec()}}};e.default=l}).call(this,o("6e42")["default"])},5028:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},n=[];o.d(e,"a",function(){return a}),o.d(e,"b",function(){return n})},"7c21":function(t,e,o){"use strict";o.r(e);var a=o("5028"),n=o("b684");for(var s in n)"default"!==s&&function(t){o.d(e,t,function(){return n[t]})}(s);var i=o("2877"),r=Object(i["a"])(n["default"],a["a"],a["b"],!1,null,null,null);e["default"]=r.exports},b684:function(t,e,o){"use strict";o.r(e);var a=o("0eb5"),n=o.n(a);for(var s in a)"default"!==s&&function(t){o.d(e,t,function(){return a[t]})}(s);e["default"]=n.a}},[["5ab8","common/runtime","common/vendor"]]]);