(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/storage/storage-upperShelf"],{"18f2":function(t,e,o){"use strict";o.r(e);var s=o("ed3e"),i=o("60a7");for(var n in i)"default"!==n&&function(t){o.d(e,t,function(){return i[t]})}(n);var a=o("2877"),r=Object(a["a"])(i["default"],s["a"],s["b"],!1,null,null,null);e["default"]=r.exports},"36f3":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=r(o("2e17")),i=r(o("f2a9")),n=r(o("00e0")),a=r(o("409c"));function r(t){return t&&t.__esModule?t:{default:t}}var u=function(){return o.e("components/barcode-input/barcode-input").then(o.bind(null,"d7ce"))},l={components:{barcodeInput:u},data:function(){return{details:[],old:{scrollTop:0},scrollTop:0,scrollHeight:0,placeholder_store:"",isStorageBin:null,binNo:"",binWhNo:""}},onLoad:function(t){var e=this;this.isStorageBin=n.default.get(i.default.storageKeys.IsStorageBin),this.isStorageBin?e.placeholder_store="扫描储位":e.placeholder_store="扫描仓库"},onReady:function(){a.default.getListHeight(this)},onBackPress:function(t){return a.default.backPress(t,this.details.length>0)},methods:{onScanStorage:function(e){var o=this;t.showLoading({mask:!0}),this.isStorageBin?s.default.bas_storagebin({data:{binNo:e},success:function(e){console.log(a.default.outputLog(e)," at pages\\storage\\storage-upperShelf.vue:88"),e.length<=0?(t.showToast({title:"货架不存在!",icon:"none"}),o.$refs.input_store.setFocus(),o.$refs.input_store.clear(),a.default.showAudio()):(o.binNo=e[0].binNo,o.binWhNo=e[0].whNo,o.$refs.input_part.setFocus(),a.default.showScanedAudio())},failure:function(t){o.$refs.input_store.setFocus(),a.default.showAudio()},complete:function(e,o,s){a.default.tryCatchApi({status:e,message:o}),t.hideLoading()}}):s.default.bas_wh({data:{filter:'whNo = "'+e+'"'},success:function(e){console.log(a.default.outputLog(e)," at pages\\storage\\storage-upperShelf.vue:122"),e.length<=0?(t.showToast({title:"仓库不存在!",icon:"none"}),o.$refs.input_store.clear(),o.$refs.input_store.setFocus(),a.default.showAudio()):(o.binWhNo=e[0].whNo,o.$refs.input_part.setFocus())},failure:function(t){o.$refs.input_store.setFocus(),a.default.showAudio()},complete:function(e,o,s){a.default.tryCatchApi({status:e,message:o}),t.hideLoading()}})},onPartScaned:function(e){var o=this,i=this;t.showLoading({title:"加载中...",mask:!0}),s.default.OpenMes_mesqrcodeinout({data:{qrCode:e},success:function(n){for(var r=0;r<o.details.length;r++){var u=o.details[r];if(u.qrCode==e)return o.onScrollTop(r),void t.showModal({title:"提示",content:"该标签已扫描,是否要删除",success:function(t){t.confirm?i.details.splice(r,1):t.cancel}})}s.default.storage_Transfer({data:{inoutFlag:"1",tagId:n.tagId,binNo:i.binNo||i.binWhNo},success:function(t){n.tagDetails?n.tagDetails.forEach(function(t){t.binNo_Up=i.binNo||i.binWhNo,t.binWhNo_Up=i.binWhNo}):(n.binNo_Up=i.binNo||i.binWhNo,n.binWhNo_Up=i.binWhNo),i.details.push({model:n,qrCode:e}),a.default.showScanedAudio()},failure:function(t){a.default.showAudio()},complete:function(e,o,s){a.default.tryCatchApi({status:e,message:o}),t.hideLoading()}})},failure:function(t){a.default.showAudio()},complete:function(e,s,i){o.$refs.input_part.setFocus(),a.default.tryCatchApi({status:e,message:s}),t.hideLoading()}})},save:function(){var e=this;if(this.isStorageBin){if(""==this.binNo.trim())return t.showToast({title:"请扫描货架",icon:"none"}),void this.$refs.input_store.setFocus()}else if(""==this.binWhNo.trim())return t.showToast({title:"请扫描库位",icon:"none"}),void this.$refs.input_store.setFocus();if(0==this.details.length)return t.showToast({title:"请先扫描上架物料",icon:"none"}),void this.$refs.input_part.setFocus();for(var o=this,n=[],r=0;r<this.details.length;r++){var u=this.details[r];if(u.model.tagDetails)u.model.tagDetails.forEach(function(t){var e={};e.sheetType=t.sheetType,e.sheetNo=t.sheetNo,e.sheetLot=t.sheetLot,e.partNo=t.partNo,e.purLot=t.poMoSoLot,e.proLot=t.proLot,e.sheetQty=t.sheetQty,e.inLot=t.inLot,e.proDate=t.proDate,e.tagId=t.tagId,e.boxTagId=t.boxTagId,e.custTagId=t.custTagId,e.ordLot=t.ordLot,e.custNo=t.custNo,o.isStorageBin?(e.binNo=o.binNo,e.binWhNo=o.binWhNo):(e.binNo=o.binWhNo,e.binWhNo=o.binWhNo),e.qrCode=u.qrCode,e.sourceType="1",e.inoutFlag="1",e.entityState=i.default.entityState.added,n.push(e),console.log("箱---------"," at pages\\storage\\storage-upperShelf.vue:293")});else{var l={};l.sheetType=u.model.sheetType,l.sheetNo=u.model.sheetNo,l.sheetLot=u.model.sheetLot,l.partNo=u.model.partNo,l.purLot=u.model.poMoSoLot,l.proLot=u.model.proLot,l.sheetQty=u.model.sheetQty,l.inLot=u.model.inLot,l.proDate=u.model.proDate,l.tagId=u.model.tagId,l.boxTagId=u.model.boxTagId,l.custTagId=u.model.custTagId,l.ordLot=u.model.ordLot,l.custNo=u.model.custNo,this.isStorageBin?(l.binNo=this.binNo,l.binWhNo=this.binWhNo):(l.binNo=this.binWhNo,l.binWhNo=this.binWhNo),l.qrCode=u.qrCode,l.sourceType="1",l.inoutFlag="1",l.entityState=i.default.entityState.added,n.push(l),console.log("内---------"," at pages\\storage\\storage-upperShelf.vue:323")}}return console.log(a.default.outputLog(n)," at pages\\storage\\storage-upperShelf.vue:326"),t.showLoading({title:"加载中",mask:!0}),s.default.stroage_TransferSide({data:n,success:function(s){t.showToast({title:"保存成功"}),a.default.dataInit(e),o.isStorageBin?o.placeholder_store="扫描储位":o.placeholder_store="扫描仓库",e.$refs.input_store.setFocus(),e.$refs.input_store.clear()},failure:function(t){a.default.showAudio()},complete:function(e,o,s){a.default.tryCatchApi({status:e,message:o}),t.hideLoading()}}),n},onSelectedItem:function(t){for(var e=0;e<this.details.length;e++){var o=this.details[e];o.selectItemClass=e==t?"uni-list-cell-selected":""}},scroll:function(t){this.old.scrollTop=t.detail.scrollTop},onScrollTop:function(e){var o=this,s=t.createSelectorQuery().in(this).select(".scroll-view-item");s.boundingClientRect(function(t){o.scrollTop=o.old.scrollTop,o.$nextTick(function(){this.scrollTop=t.height*e})}).exec()}}};e.default=l}).call(this,o("6e42")["default"])},"60a7":function(t,e,o){"use strict";o.r(e);var s=o("36f3"),i=o.n(s);for(var n in s)"default"!==n&&function(t){o.d(e,t,function(){return s[t]})}(n);e["default"]=i.a},ed3e:function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c},i=[];o.d(e,"a",function(){return s}),o.d(e,"b",function(){return i})}},[["13cf","common/runtime","common/vendor"]]]);