(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/boxMng/box-lastTest"],{"0023":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.order.tagDetails,function(e,o){var n=t._f("convertVal")(e.isScaned);return{$orig:t.__get_orig(e),f0:n}}));t.$mp.data=Object.assign({},{$root:{l0:o}})},a=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return a})},"1de1":function(t,e,o){"use strict";o.r(e);var n=o("0023"),a=o("ff10");for(var s in a)"default"!==s&&function(t){o.d(e,t,function(){return a[t]})}(s);var i=o("2877"),u=Object(i["a"])(a["default"],n["a"],n["b"],!1,null,null,null);e["default"]=u.exports},6736:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(o("2e17")),a=(s(o("f2a9")),s(o("00e0")),s(o("409c")));function s(t){return t&&t.__esModule?t:{default:t}}var i=function(){return o.e("components/barcode-input/barcode-input").then(o.bind(null,"d7ce"))},u={components:{barcodeInput:i},data:function(){return{old:{scrollTop:0},scrollTop:0,scrollHeight:0,order:{tagDetails:[]}}},filters:{convertVal:function(t){return t?"✔":"否"}},onReady:function(){a.default.getListHeight(this)},onBackPress:function(t){return a.default.backPress(t,this.order.tagDetails.length>0)},methods:{onBoxScaned:function(e){var o=this;t.showLoading({mask:!0}),n.default.boxfqc_boxScan({data:{boxQrCode:e},success:function(t){console.log(a.default.outputLog(t)," at pages\\boxMng\\box-lastTest.vue:81");for(var e=0;e<t.tagDetails.length;e++)t.tagDetails[e].isScaned=!1;o.order=t,a.default.showScanedAudio(),o.$refs.input_part.setFocus()},failure:function(t){a.default.showAudio(),o.$refs.input_box.setFocus()},complete:function(e,o,n){a.default.tryCatchApi({status:e,message:o}),t.hideLoading()}})},onPartScaned:function(e){var o=this,s=this;t.showLoading({mask:!0}),n.default.boxfqc_QRCodeAnalysis({data:{qrCode:e,enumBarCode:5},success:function(e){console.log(a.default.outputLog(e)," at pages\\boxMng\\box-lastTest.vue:114");for(var n=-1,i=0;i<o.order.tagDetails.length;i++){var u=o.order.tagDetails[i];if(u.tagId==e.tagId){if(o.onScrollTop(i),u.isScaned)return t.showToast({title:"当前标签已校验过了",icon:"none"}),a.default.showAudio(),void o.$refs.input_part.setFocus();n=i;break}}if(-1==n)return t.showToast({title:"标签扫描错误，该标签不在箱子中",icon:"none"}),a.default.showAudio(),void s.$refs.input_part.setFocus();t.showToast({title:"校验成功"}),a.default.showScanedAudio(),o.order.tagDetails[n].isScaned=!0},failure:function(t){a.default.showAudio()},complete:function(e,n,s){o.$refs.input_part.setFocus(),a.default.tryCatchApi({status:e,message:n}),t.hideLoading()}})},onSave:function(){if(0==this.order.tagDetails.length)return t.showToast({title:"请扫描外箱",icon:"none"}),a.default.showAudio(),void this.$refs.input_box.setFocus();for(var e=-1,o=0;o<this.order.tagDetails.length;o++){var n=this.order.tagDetails[o];if(!n.isScaned){e=o;break}}-1!=e?(this.onScrollTop(e),t.showModal({title:"提示",content:"还有物料没有扫描,是否继续操作？",success:function(t){t.confirm||t.cancel&&this.onSave(1)}}),a.default.showAudio(),this.$refs.input_box.setFocus()):this.onSave1(0)},onSave1:function(e){var o=this;t.showLoading({mask:!0}),n.default.boxOpen_post({data:{boxTagIds:this.order.tagId,boxSw:e},success:function(e){t.showToast({title:"操作完成",icon:"none",mask:!0}),a.default.dataInit(o),a.default.showScanedAudio(),o.$refs.input_box.setFocus()},failure:function(t){a.default.showAudio()},complete:function(e,n,s){o.$refs.input_box.setFocus(),a.default.tryCatchApi({status:e,message:n}),t.hideLoading()}})},onSelectedItem:function(t){for(var e=a.default.clone(this.order.tagDetails),o=0;o<e.length;o++){var n=e[o];n.selectItemClass=o==t?"uni-list-cell-selected":""}this.order.tagDetails=e},scroll:function(t){this.old.scrollTop=t.detail.scrollTop},onScrollTop:function(e){var o=this;this.onSelectedItem(e);var n=t.createSelectorQuery().in(this).select(".scroll-view-item");n.boundingClientRect(function(t){o.scrollTop=o.old.scrollTop,o.$nextTick(function(){null!=t&&(this.scrollTop=t.height*e)})}).exec()}}};e.default=u}).call(this,o("6e42")["default"])},ff10:function(t,e,o){"use strict";o.r(e);var n=o("6736"),a=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,function(){return n[t]})}(s);e["default"]=a.a}},[["b77a","common/runtime","common/vendor"]]]);